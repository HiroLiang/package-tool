import{d as N,u as T,a as j,r as p,w as P,c as s,b as o,F as h,e as m,f as V,g as $,h as q,i as k,o as t,j as w,t as y,k as W,v as D,n as x,N as E,_ as A}from"./index-BBHp_ngw.js";const F={class:"list-box"},M={class:"project-box"},U={class:"branch-box"},z=["onUpdate:modelValue"],H={class:"branch-list"},I=["onClick"],O=["onClick"],G={class:"button-box"},J={key:0,class:"overlay-cover"},K=N({__name:"BranchList",props:{branchList:{type:Object,required:!0},selectedProject:{type:String,required:!0},gitAccount:{type:String,required:!0},accessToken:{type:String,required:!0}},setup(B){const b=T(),g=j(),r=p(!1),f=p([]),_=p(null),i=p([]),l=p([]),c=B;P(c,()=>{i.value=[],c.branchList.forEach(()=>{i.value.push("")})});const C=(e,d)=>e==l.value[d]?"background-color: #e7ebec;":"",S=()=>{l.value.length==2&&b.info({title:"確認 dap-api 分支",content:`${l.value[0]}`,positiveText:"確認",negativeText:"取消",onPositiveClick:()=>{b.info({title:"確認dap-api-admin分支",content:`${l.value[1]}`,positiveText:"確認",negativeText:"取消",onPositiveClick(){let e=[];e.push(c.selectedProject),e.push(c.gitAccount),e.push(c.accessToken),l.value.forEach(d=>{console.log(d),e.push(d.replace("origin/",""))}),console.log(e),u.send(e.join(",split,")),r.value=!0},onNegativeClick:()=>{g.warning({description:"取消包版",duration:1e3})}})},onNegativeClick:()=>{g.warning({description:"取消包版",duration:1e3})}})},L=()=>{_.value&&_.value.scroll({top:_.value.scrollHeight,way:"instant"})},u=new WebSocket("ws://localhost:8080/compiler");return u.onopen=e=>{console.log("WebSocket connected."),u.send("Project : "+c.selectedProject)},u.onmessage=function(e){if(e.data=="y"){r.value=!1,f.value=[],g.success({description:"包版完成",duration:3e3});return}if(e.data=="n"){r.value=!1,f.value=[],g.error({description:"包版失敗"});return}e.data.startsWith("{show}")&&r&&(f.value.push(e.data.replace("{show}","")),L())},u.onclose=function(e){console.log("WebSocket closed.")},(e,d)=>(t(),s(h,null,[o("div",F,[o("div",M,[(t(!0),s(h,null,m(e.$props.branchList,(v,a)=>(t(),s("div",U,[o("span",null,[w(y(v.name+" ")+"分支： ",1),W(o("input",{type:"text","onUpdate:modelValue":n=>i.value[a]=n},null,8,z),[[D,i.value[a]]])]),o("div",H,[o("ul",null,["master".includes(i.value[a])?(t(),s("li",{key:0,onClick:n=>l.value[a]="master",style:x(C("master",a))},"origin/master",12,I)):k("",!0),(t(!0),s(h,null,m(v.list,n=>(t(),s(h,{key:n},[n.includes(i.value[a])?(t(),s("li",{key:0,onClick:Q=>l.value[a]=n,style:x(C(n,a))},y(n),13,O)):k("",!0)],64))),128))])])]))),256))]),o("div",G,[c.branchList.length>0?(t(),V(q(E),{key:0,type:"info",strong:"",secondary:"",onClick:S},{default:$(()=>[w("確認")]),_:1})):k("",!0)])]),r.value?(t(),s("div",J,[o("div",{class:"server-message",ref_key:"messageBox",ref:_},[o("ul",null,[(t(!0),s(h,null,m(f.value,v=>(t(),s("li",{key:v},y(v),1))),128))])],512)])):k("",!0)],64))}}),X=A(K,[["__scopeId","data-v-f99754c2"]]);export{X as default};
